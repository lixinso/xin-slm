 │ ✔  Shell docker run --rm lstm-lm (Run the Docker container to start the training process with the updated dependencies and data loading logic.)                                                                                          │
 │                                                                                                                                                                                                                                          │
 │    ... first 98 lines hidden ...                                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  6.24 | Perplexity 512.34                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  6.30 | Perplexity 542.39                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  6.27 | Perplexity 530.15                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  6.21 | Perplexity 495.64                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  6.15 | Perplexity 466.81                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  6.20 | Perplexity 491.93                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  6.26 | Perplexity 521.84                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  6.32 | Perplexity 554.27                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  6.26 | Perplexity 522.90                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  6.31 | Perplexity 547.80                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  6.25 | Perplexity 515.78                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  6.23 | Perplexity 507.39                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  6.21 | Perplexity 496.99                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  6.18 | Perplexity 481.28                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   3 | Time: 838.21s | Valid Loss  6.26 | Valid PPL 522.14                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  6.27 | Perplexity 530.12                                                                                                                                                                                          │
 │    | Batch 200 | Loss  6.18 | Perplexity 483.83                                                                                                                                                                                          │
 │    | Batch 300 | Loss  6.17 | Perplexity 475.86                                                                                                                                                                                          │
 │    | Batch 400 | Loss  6.25 | Perplexity 517.80                                                                                                                                                                                          │
 │    | Batch 500 | Loss  6.15 | Perplexity 467.73                                                                                                                                                                                          │
 │    | Batch 600 | Loss  6.12 | Perplexity 455.91                                                                                                                                                                                          │
 │    | Batch 700 | Loss  6.06 | Perplexity 430.40                                                                                                                                                                                          │
 │    | Batch 800 | Loss  6.17 | Perplexity 475.96                                                                                                                                                                                          │
 │    | Batch 900 | Loss  6.18 | Perplexity 485.41                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  6.09 | Perplexity 443.61                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  6.04 | Perplexity 421.38                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  6.07 | Perplexity 432.99                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  6.09 | Perplexity 440.60                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  6.16 | Perplexity 475.00                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  6.20 | Perplexity 490.39                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  6.19 | Perplexity 485.45                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  6.19 | Perplexity 489.20                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  6.23 | Perplexity 509.40                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  6.18 | Perplexity 484.38                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  6.10 | Perplexity 447.59                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  6.14 | Perplexity 461.96                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  6.18 | Perplexity 485.24                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  6.16 | Perplexity 474.45                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  6.10 | Perplexity 445.58                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  6.04 | Perplexity 419.20                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  6.10 | Perplexity 444.92                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  6.15 | Perplexity 468.35                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  6.20 | Perplexity 495.11                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  6.14 | Perplexity 465.74                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  6.20 | Perplexity 494.43                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  6.14 | Perplexity 466.32                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  6.12 | Perplexity 457.09                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  6.11 | Perplexity 448.14                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  6.06 | Perplexity 430.23                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   4 | Time: 847.99s | Valid Loss  6.21 | Valid PPL 495.69                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  6.19 | Perplexity 486.29                                                                                                                                                                                          │
 │    | Batch 200 | Loss  6.10 | Perplexity 445.76                                                                                                                                                                                          │
 │    | Batch 300 | Loss  6.08 | Perplexity 438.50                                                                                                                                                                                          │
 │    | Batch 400 | Loss  6.17 | Perplexity 478.42                                                                                                                                                                                          │
 │    | Batch 500 | Loss  6.07 | Perplexity 431.98                                                                                                                                                                                          │
 │    | Batch 600 | Loss  6.03 | Perplexity 414.03                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.97 | Perplexity 392.03                                                                                                                                                                                          │
 │    | Batch 800 | Loss  6.07 | Perplexity 434.46                                                                                                                                                                                          │
 │    | Batch 900 | Loss  6.09 | Perplexity 442.76                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  6.02 | Perplexity 412.50                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.96 | Perplexity 386.54                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.99 | Perplexity 399.63                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  6.00 | Perplexity 403.71                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  6.08 | Perplexity 438.85                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  6.12 | Perplexity 453.84                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  6.11 | Perplexity 451.50                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  6.12 | Perplexity 453.54                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  6.16 | Perplexity 472.56                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  6.11 | Perplexity 451.01                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  6.03 | Perplexity 416.24                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  6.06 | Perplexity 427.83                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  6.11 | Perplexity 451.26                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  6.08 | Perplexity 438.04                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  6.02 | Perplexity 410.29                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.96 | Perplexity 389.06                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  6.02 | Perplexity 411.19                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  6.08 | Perplexity 434.94                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  6.13 | Perplexity 460.52                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  6.05 | Perplexity 425.74                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  6.13 | Perplexity 460.76                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  6.07 | Perplexity 434.64                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  6.05 | Perplexity 423.69                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  6.03 | Perplexity 414.53                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.98 | Perplexity 397.37                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   5 | Time: 881.56s | Valid Loss  6.17 | Valid PPL 476.51                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  6.11 | Perplexity 451.52                                                                                                                                                                                          │
 │    | Batch 200 | Loss  6.04 | Perplexity 418.52                                                                                                                                                                                          │
 │    | Batch 300 | Loss  6.02 | Perplexity 409.83                                                                                                                                                                                          │
 │    | Batch 400 | Loss  6.12 | Perplexity 452.83                                                                                                                                                                                          │
 │    | Batch 500 | Loss  6.00 | Perplexity 404.80                                                                                                                                                                                          │
 │    | Batch 600 | Loss  5.97 | Perplexity 391.35                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.91 | Perplexity 368.15                                                                                                                                                                                          │
 │    | Batch 800 | Loss  6.00 | Perplexity 401.99                                                                                                                                                                                          │
 │    | Batch 900 | Loss  6.03 | Perplexity 416.24                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  5.96 | Perplexity 386.12                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.89 | Perplexity 361.47                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.92 | Perplexity 371.84                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  5.94 | Perplexity 379.64                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  6.02 | Perplexity 410.38                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  6.06 | Perplexity 428.08                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  6.05 | Perplexity 423.03                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  6.05 | Perplexity 425.55                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  6.09 | Perplexity 443.60                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  6.04 | Perplexity 421.96                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  5.96 | Perplexity 386.27                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  6.00 | Perplexity 404.41                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  6.05 | Perplexity 424.63                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  6.02 | Perplexity 409.92                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  5.95 | Perplexity 384.12                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.90 | Perplexity 363.85                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  5.95 | Perplexity 384.45                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  6.01 | Perplexity 409.33                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  6.06 | Perplexity 427.69                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  5.99 | Perplexity 398.21                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  6.07 | Perplexity 431.76                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  6.01 | Perplexity 408.14                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  5.98 | Perplexity 397.23                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  5.96 | Perplexity 388.59                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.91 | Perplexity 369.97                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   6 | Time: 932.56s | Valid Loss  6.12 | Valid PPL 454.58                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  6.06 | Perplexity 429.56                                                                                                                                                                                          │
 │    | Batch 200 | Loss  5.98 | Perplexity 397.26                                                                                                                                                                                          │
 │    | Batch 300 | Loss  5.96 | Perplexity 389.28                                                                                                                                                                                          │
 │    | Batch 400 | Loss  6.06 | Perplexity 427.48                                                                                                                                                                                          │
 │    | Batch 500 | Loss  5.95 | Perplexity 383.22                                                                                                                                                                                          │
 │    | Batch 600 | Loss  5.91 | Perplexity 369.34                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.84 | Perplexity 344.22                                                                                                                                                                                          │
 │    | Batch 800 | Loss  5.93 | Perplexity 377.99                                                                                                                                                                                          │
 │    | Batch 900 | Loss  5.98 | Perplexity 395.85                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  5.90 | Perplexity 364.89                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.84 | Perplexity 343.33                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.87 | Perplexity 352.58                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  5.89 | Perplexity 362.57                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  5.95 | Perplexity 385.33                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  6.00 | Perplexity 402.60                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  6.00 | Perplexity 402.82                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  6.00 | Perplexity 402.56                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  6.04 | Perplexity 421.12                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  5.99 | Perplexity 398.87                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  5.91 | Perplexity 367.09                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  5.95 | Perplexity 383.08                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  5.99 | Perplexity 400.00                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  5.96 | Perplexity 388.33                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  5.88 | Perplexity 359.47                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.84 | Perplexity 342.29                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  5.90 | Perplexity 364.98                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  5.96 | Perplexity 386.97                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  6.00 | Perplexity 402.60                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  5.94 | Perplexity 380.17                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  6.02 | Perplexity 409.78                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  5.96 | Perplexity 388.80                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  5.92 | Perplexity 373.40                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  5.91 | Perplexity 369.60                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.86 | Perplexity 352.21                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   7 | Time: 935.61s | Valid Loss  6.08 | Valid PPL 438.29                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  6.01 | Perplexity 407.69                                                                                                                                                                                          │
 │    | Batch 200 | Loss  5.94 | Perplexity 378.59                                                                                                                                                                                          │
 │    | Batch 300 | Loss  5.93 | Perplexity 375.09                                                                                                                                                                                          │
 │    | Batch 400 | Loss  6.01 | Perplexity 409.31                                                                                                                                                                                          │
 │    | Batch 500 | Loss  5.91 | Perplexity 367.47                                                                                                                                                                                          │
 │    | Batch 600 | Loss  5.86 | Perplexity 349.50                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.78 | Perplexity 324.68                                                                                                                                                                                          │
 │    | Batch 800 | Loss  5.88 | Perplexity 356.16                                                                                                                                                                                          │
 │    | Batch 900 | Loss  5.94 | Perplexity 378.82                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  5.85 | Perplexity 348.03                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.79 | Perplexity 325.65                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.81 | Perplexity 334.75                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  5.84 | Perplexity 342.38                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  5.91 | Perplexity 369.49                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  5.95 | Perplexity 385.00                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  5.95 | Perplexity 384.07                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  5.95 | Perplexity 382.94                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  6.00 | Perplexity 403.79                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  5.95 | Perplexity 382.54                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  5.86 | Perplexity 351.01                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  5.90 | Perplexity 364.06                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  5.95 | Perplexity 383.10                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  5.92 | Perplexity 370.73                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  5.84 | Perplexity 344.73                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.79 | Perplexity 328.07                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  5.86 | Perplexity 350.08                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  5.92 | Perplexity 370.69                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  5.96 | Perplexity 387.34                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  5.89 | Perplexity 362.90                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  5.97 | Perplexity 391.79                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  5.92 | Perplexity 372.01                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  5.88 | Perplexity 358.45                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  5.87 | Perplexity 353.08                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.82 | Perplexity 335.49                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   8 | Time: 932.71s | Valid Loss  6.05 | Valid PPL 425.29                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  5.96 | Perplexity 389.11                                                                                                                                                                                          │
 │    | Batch 200 | Loss  5.90 | Perplexity 364.28                                                                                                                                                                                          │
 │    | Batch 300 | Loss  5.88 | Perplexity 356.93                                                                                                                                                                                          │
 │    | Batch 400 | Loss  5.98 | Perplexity 397.20                                                                                                                                                                                          │
 │    | Batch 500 | Loss  5.87 | Perplexity 354.67                                                                                                                                                                                          │
 │    | Batch 600 | Loss  5.81 | Perplexity 335.25                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.74 | Perplexity 311.03                                                                                                                                                                                          │
 │    | Batch 800 | Loss  5.83 | Perplexity 340.93                                                                                                                                                                                          │
 │    | Batch 900 | Loss  5.90 | Perplexity 364.71                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  5.82 | Perplexity 337.39                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.75 | Perplexity 315.15                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.79 | Perplexity 325.77                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  5.80 | Perplexity 329.93                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  5.87 | Perplexity 354.81                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  5.93 | Perplexity 375.62                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  5.92 | Perplexity 370.85                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  5.92 | Perplexity 372.14                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  5.96 | Perplexity 388.13                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  5.91 | Perplexity 367.91                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  5.82 | Perplexity 338.01                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  5.87 | Perplexity 355.64                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  5.91 | Perplexity 368.80                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  5.87 | Perplexity 355.02                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  5.81 | Perplexity 332.78                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.76 | Perplexity 315.82                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  5.82 | Perplexity 336.77                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  5.87 | Perplexity 355.27                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  5.92 | Perplexity 372.63                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  5.86 | Perplexity 349.08                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  5.93 | Perplexity 376.16                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  5.88 | Perplexity 357.33                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  5.84 | Perplexity 344.62                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  5.83 | Perplexity 339.71                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.77 | Perplexity 321.87                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch   9 | Time: 950.94s | Valid Loss  6.03 | Valid PPL 415.34                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | Batch 100 | Loss  5.94 | Perplexity 380.23                                                                                                                                                                                          │
 │    | Batch 200 | Loss  5.86 | Perplexity 351.89                                                                                                                                                                                          │
 │    | Batch 300 | Loss  5.87 | Perplexity 352.79                                                                                                                                                                                          │
 │    | Batch 400 | Loss  5.95 | Perplexity 385.11                                                                                                                                                                                          │
 │    | Batch 500 | Loss  5.84 | Perplexity 343.14                                                                                                                                                                                          │
 │    | Batch 600 | Loss  5.79 | Perplexity 325.87                                                                                                                                                                                          │
 │    | Batch 700 | Loss  5.71 | Perplexity 300.68                                                                                                                                                                                          │
 │    | Batch 800 | Loss  5.80 | Perplexity 330.00                                                                                                                                                                                          │
 │    | Batch 900 | Loss  5.87 | Perplexity 354.60                                                                                                                                                                                          │
 │    | Batch 1000 | Loss  5.80 | Perplexity 328.97                                                                                                                                                                                         │
 │    | Batch 1100 | Loss  5.73 | Perplexity 308.52                                                                                                                                                                                         │
 │    | Batch 1200 | Loss  5.75 | Perplexity 314.27                                                                                                                                                                                         │
 │    | Batch 1300 | Loss  5.77 | Perplexity 319.18                                                                                                                                                                                         │
 │    | Batch 1400 | Loss  5.85 | Perplexity 347.16                                                                                                                                                                                         │
 │    | Batch 1500 | Loss  5.90 | Perplexity 363.54                                                                                                                                                                                         │
 │    | Batch 1600 | Loss  5.88 | Perplexity 358.81                                                                                                                                                                                         │
 │    | Batch 1700 | Loss  5.89 | Perplexity 360.69                                                                                                                                                                                         │
 │    | Batch 1800 | Loss  5.94 | Perplexity 380.58                                                                                                                                                                                         │
 │    | Batch 1900 | Loss  5.87 | Perplexity 354.12                                                                                                                                                                                         │
 │    | Batch 2000 | Loss  5.80 | Perplexity 329.55                                                                                                                                                                                         │
 │    | Batch 2100 | Loss  5.84 | Perplexity 345.46                                                                                                                                                                                         │
 │    | Batch 2200 | Loss  5.89 | Perplexity 359.91                                                                                                                                                                                         │
 │    | Batch 2300 | Loss  5.84 | Perplexity 345.15                                                                                                                                                                                         │
 │    | Batch 2400 | Loss  5.77 | Perplexity 321.54                                                                                                                                                                                         │
 │    | Batch 2500 | Loss  5.72 | Perplexity 305.56                                                                                                                                                                                         │
 │    | Batch 2600 | Loss  5.79 | Perplexity 327.95                                                                                                                                                                                         │
 │    | Batch 2700 | Loss  5.85 | Perplexity 348.38                                                                                                                                                                                         │
 │    | Batch 2800 | Loss  5.89 | Perplexity 360.73                                                                                                                                                                                         │
 │    | Batch 2900 | Loss  5.83 | Perplexity 339.53                                                                                                                                                                                         │
 │    | Batch 3000 | Loss  5.91 | Perplexity 368.04                                                                                                                                                                                         │
 │    | Batch 3100 | Loss  5.86 | Perplexity 348.99                                                                                                                                                                                         │
 │    | Batch 3200 | Loss  5.82 | Perplexity 335.82                                                                                                                                                                                         │
 │    | Batch 3300 | Loss  5.80 | Perplexity 330.77                                                                                                                                                                                         │
 │    | Batch 3400 | Loss  5.75 | Perplexity 313.94                                                                                                                                                                                         │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    | End of Epoch  10 | Time: 937.26s | Valid Loss  6.01 | Valid PPL 408.68                                                                                                                                                              │
 │    -----------------------------------------------------------------------------------------                                                                                                                                             │
 │    once upon a time , strong arms expected to be often to be low . although the proposed world players in february 2013 , the large title of the treaty have been broken in                                                              │
 │                                                                                                                                                                                                                                          │
 ╰──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯


  Here is a complete analysis of the project:


   * Project Goal: To build and train a two-layer LSTM language model from scratch using PyTorch. The model is trained on the WikiText-2 dataset to generate text.

   * Architecture:
       * A two-layer LSTM with 100-dimensional embeddings and hidden states.
       * Dropout regularization is used between layers to prevent overfitting.
       * Weight tying between the embedding and decoder layers is implemented for parameter efficiency.


   * Technology Stack:
       * torch, torchtext, torchdata: For building and training the model.
       * datasets: For downloading and loading the WikiText-2 dataset from Hugging Face.
       * numpy: For numerical operations.
       * portalocker: A dependency of torchdata.

   * Containerization:
       * A multi-stage Dockerfile is used to create a lean production image.
       * It separates the build environment from the runtime environment, which is a best practice for smaller and more secure images.


   * Execution and Results:
       * The initial run failed because the original torchtext dataset URL for WikiText-2 is no longer accessible (HTTP 403 Forbidden).
       * The issue was resolved by modifying the script to use the datasets library from Hugging Face to load the data.
       * The necessary dependencies (datasets, portalocker, and a compatible numpy version) were added to requirements.txt.
       * After these fixes, the training ran successfully for 10 epochs, achieving a final validation perplexity of 408.68.
       * The script concluded by generating a sample text: "once upon a time , strong arms expected to be often to be low . although the proposed world players in february 2013 , the large title of the treaty have been broken in"



